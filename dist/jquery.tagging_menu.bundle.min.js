"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a,b,c){var d={init:function(b,c){var d=this;d.$elem=a(c),d.options=a.extend({},a.fn.senseCard.options,b),d._create()},toggleDef:function(){var a=this,b=a.$elem.find(".idl-def-tgl");b.size()>0&&a._toggleDefEH(b.first())},destroy:function(){this.$elem.removeData("senseCard")},_create:function(){var b=this;b.$elem.find(".idl-def-tgl").click(function(c){b._toggleDefEH(a(this)),c.preventDefault(),c.stopPropagation()});var c=b.$elem.find(".idl-sense-edit");c.size()>0&&(c.click(function(c){var d=a(this).closest(".idl-tile-container");b._senseEditEH(d),c.preventDefault(),c.stopPropagation()}),b._loadLgcc())},_toggleDefEH:function(a){var b=a.closest(".idl-sensetile"),c=b.children(".idl-def"),d=c.is(":visible");d?(c.slideUp(300),a.removeClass("idl-def-hide-icon").addClass("idl-def-show-icon")):(c.slideDown(300),a.removeClass("idl-def-show-icon").addClass("idl-def-hide-icon"))},_senseEditEH:function(c){var d=this,e="This functionality is not available at this time. Please retry later.";if(!(b.com&&com.idilia&&com.idilia.lgcc))return void alert(e);c.css("cursor","progress");var f=c.data("fsk"),g=c.data("len")||1,h=c.attr("class").match(/idl-tmplt-[\w-]*\b/)[0].substring(10),i=c.data("customer"),j=c.data("auth-token");com.idilia.lgcc.editMeaning(this.$elem,this.options.lgcc,{customerId:i,token:j,sk:f,tmplt:h,len:g,v:1}).done(function(b){if(b&&b.card){var e=a(b.card),f=d.options;c.replaceWith(e),e.senseCard(f),"function"==typeof f.edited&&d.options.edited.call(e[0])}}).fail(function(a){alert(e)}).always(function(){c.css("cursor","")})},_loadLgcc:function(){b.com&&com.idilia&&com.idilia.lgcc||a("#lgcc-script").size()>0||a("head").append('<script id="lgcc-script" type="application/javascript" src="'+this.options.lgcc+'apijs/lgcc.js"></script>')},end:null};a.fn.senseCard=function(b){return this.each(function(){var c=a(this),e=c.data("senseCard");void 0===e&&(e=Object.create(d),c.data("senseCard",e)),e.init(b,this)})},a.fn.senseCard.options={edited:null,lgcc:"https://lgcc.idilia.com/lgcc/"}}(jQuery,window,document),"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a,b,c){var d={init:function(b,c){var d=this;d.$elem=a(c),d.options=a.extend({},a.fn.senseMenu.options,d.$elem.data(),b),d.$selTile=null,d.navE=null,d.carouselW=null,d.view=d.options.view,d.nTiles=null,d.tileWidth=null,d.widthInTiles=null,d._create()},select:function(a){var b=this,c={$selTile:a};b.$selTile&&(c.$prevTile=b.$selTile),b.$selTile!=a&&b.$selTile&&b.$selTile.removeClass("idl-sensesel"),a.hasClass("idl-tile-create")?(b.$seltile=null,b.options.createsel.call(this,c)):"function"==typeof b.options.sensesel&&(a.addClass("idl-sensesel"),b.$selTile=a,b.options.sensesel.call(this,c))},setView:function(a){var b=this;b.view!=a&&b.$elem.is(":visible")&&b.open(a),b.view=a},open:function(a){var b=this;return a&&(b.view=a),b.carouselW&&"carousel"!=b.view&&(b.carouselW.destroy(),b.carouselW=null),b._adjustWidth(),b.$elem.removeClass("hidden").addClass("idl-sensemenu-open"),"grid"===b.view?b._createGrid():"carousel"===b.view&&b._createCarousel(),this},close:function(){var a=this;return a.$elem.addClass("hidden").removeClass("idl-sensemenu-open"),this},selected:function(){return this.$selTile},destroy:function(){var b=this;b.carouselW&&b.carouselW.destroy(),b.$elem.removeData("senseMenu"),b.$elem.children(".idl-sensetiles").children().each(function(){a(this).data("senseCard").destroy()})},_create:function(){var c=this;c.$elem.addClass("hidden"),c._createNavBar(),c.$elem.on("click",".idl-tile-container",function(b){c._unhighlightSenseGroups();var d=a(this);d.hasClass("idl-tile-create")?(c._addSenseCardEH(b,d),b.stopPropagation()):c.select(d),b.preventDefault()});var d=c.$elem.find(".idl-create-links");d.size()>0&&(d.on("click","a",function(b){c._senseCreateEH(a(this)),b.preventDefault(),b.stopPropagation()}),c._loadLgcc());var e=c._viewCtrls();void 0===a.fn.owlCarousel?(e.find(".idl-to-carousel").hide(),e.find(".idl-to-grid").hide()):(e.find(".idl-to-carousel").data("view","carousel"),e.find(".idl-to-grid").data("view","grid"),e.on("click",".idl-to-carousel, .idl-to-grid",function(b){c.setView(a(b.currentTarget).data("view"))})),e.find(".idl-def-tgl").on("click",function(b){var d=a(this),e=c.$elem.find("div.idl-def-tgl"),f=e.closest(".idl-sensetile").children(".idl-def");d.hasClass("idl-def-hide-icon")?(f.slideUp(300),e.add(d).removeClass("idl-def-hide-icon").addClass("idl-def-show-icon")):(f.slideDown(300),e.add(d).removeClass("idl-def-show-icon").addClass("idl-def-hide-icon")),b.preventDefault(),b.stopPropagation()}),a(b).resize(function(a){c.$elem.is(":visible")&&c._refreshWidth()}),c.$elem.children(".idl-sensetiles").children().senseCard({lgcc:c.options.lgcc}),c._selTileIdx()},_adjustWidth:function(a){var b=this,c=b.$elem.parent().width();if(null===b.tileWidth){var d=b.$elem.find(".idl-sensetile");b.$elem.removeClass("hidden"),b.tileWidth=d.first().outerWidth()+10,b.$elem.addClass("hidden"),b.nTiles=d.length}b.widthInTiles=Math.floor(c/b.tileWidth);var e=Math.min(b.tileWidth*b.widthInTiles,b.nTiles*b.tileWidth);return a!=e&&(b.$elem.css({width:e}),b.options.carouselOptions.items=Math.max(Math.floor(e/b.tileWidth),1)),e},_refreshWidth:function(){var a=this,b=a.$elem.width(),c=a._adjustWidth(b);c!=b&&a.carouselW&&(a.carouselW.destroy(),a.carouselW=null,a._createCarousel())},_createCarousel:function(){var b=this;b._senseTiles().removeClass(b.options.gridTileContainerClass),b.$elem.removeClass("idl-grid").addClass("idl-carousel");var c=b.$elem.children(".idl-sensetiles").first(),d=b._selTileIdx();b.carouselW=c.owlCarousel(a.extend({responsive:!1},a.fn.senseMenu.options.carouselOptions,b.options.carouselOptions)).data("owlCarousel"),d&&b.carouselW.jumpTo(d),c.find(".owl-controls").on("click",function(a){a.stopPropagation(),a.preventDefault()}),b.view="carousel",b._styleViewButtons()},_createGrid:function(){var a=this;a._senseTiles().addClass(a.options.gridTileContainerClass),a.$elem.removeClass("idl-carousel").addClass("idl-grid"),a.view="grid",a._styleViewButtons()},_createNavBar:function(){var b=this;b.navE=b.$elem.find(".idl-nav-grps").first(),b.navE&&b.navE.find("a").on("click",function(c){b._unhighlightSenseGroups();var d=a(this);d.addClass("active");var e=d.data("grp"),f='[data-grp="'+e+'"]';b._senseTiles().filter(f).addClass("idl-grpsel"),b.carouselW&&b.carouselW.jumpTo(parseInt(e,10)),c.stopPropagation(),c.preventDefault()})},_unhighlightSenseGroups:function(){var a=this;a.navE&&(a.navE.find("a").removeClass("active"),a._senseTiles().removeClass("idl-grpsel"))},_styleViewButtons:function(){var a=this,b=a._viewCtrls();"carousel"===a.view?(b.find(".idl-to-grid").removeClass("active"),b.find(".idl-to-carousel").addClass("active")):(b.find(".idl-to-carousel").removeClass("active"),b.find(".idl-to-grid").addClass("active"))},_senseTiles:function(){return this.$elem.find(".idl-tile-container")},_viewCtrls:function(){return this.$elem.children(".idl-navbar").find(".idl-view-ctrls")},_selTileIdx:function(){var a=this;if(!a.$selTile){var b=this.$elem.find(".idl-sensesel");b.length>0&&(a.$selTile=b.first())}if(a.$selTile){for(var c=0,d=a.$selTile[0];null!==(d=d.previousSibling);)c++;return c}return void 0},_addSenseCardEH:function(a,b){var c=this,d=b.find(".idl-create-link");if(1===d.size())return void c._senseCreateEH(d.first());var e=b.find(".idl-def");e.is(":visible")||(e.slideDown(300),b.css("cursor","default"))},_senseCreateEH:function(c){if(c.parent().hasClass("idl-create-link-more"))return void c.parent().hide().nextAll().show();var d="This functionality is not available at this time. Please retry later.";if(!b.com||!com.idilia||!com.idilia.lgcc)return void alert(d);var e=this,f=c.closest(".idl-tile-container"),g=f.css("cursor");f.css("cursor","progress");var h=c.text(),i=c.data("len"),j=f.attr("class").match(/idl-tmplt-[\w-]*\b/)[0].substring(10),k=f.data("customer"),l=f.data("auth-token");com.idilia.lgcc.createMeaning(this.$elem,this.options.lgcc,{customerId:k,token:l,text:h,tmplt:j,len:i,v:1}).done(function(b){if(b&&b.card){e.nTiles=e.nTiles+1,e._refreshWidth();var c=a(b.card);f.before(c),c.senseCard({lgcc:e.options.lgcc})}}).fail(function(a){alert(d)}).always(function(){f.css("cursor",g);var a=f.find(".idl-def");a.is(":visible")&&a.hide()})},_loadLgcc:function(){b.com&&com.idilia&&com.idilia.lgcc||a("#lgcc-script").size()>0||(a.ajaxSetup({cache:!0}),a("head").append('<script id="lgcc-script" type="application/javascript" src="'+this.options.lgcc+'apijs/lgcc.js"></script>'))},end:null};a.fn.senseMenu=function(b){return this.each(function(){var c=a(this),e=c.data("senseMenu");void 0===e&&(e=Object.create(d),c.data("senseMenu",e)),e.init(b,this)})},a.fn.senseMenu.options={sensesel:null,createsel:null,gridTileContainerClass:"",view:"grid",lgcc:"https://lgcc.idilia.com/lgcc/",carouselOptions:{navigation:!0,navigationText:['<svg class="idl-owl-btn idl-owl-btn-prev"><polygon points="11,3 16,3 6,29 16,56 11,56 1,29"/></svg>','<svg class="idl-owl-btn idl-owl-btn-next"><polygon points="3,3 8,3 18,29 8,56 3,56 13,29"/></svg>'],scrollPerPage:!0,pagination:!1,paginationSpeed:0,slideSpeed:100,rewindNav:!1}}}(jQuery,window,document),"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a,b,c){var d=!1,e=null,f=0,g={init:function(b,c,d){var e=this;e.$elem=c,e.$menu=d,e.options=a.extend({},e.$elem.data(),b),e.tfOff=parseInt(e.$elem.data("off"),10),e.endOff=e.tfOff+1,e.$tile=null,e.menuW=null,e._create()},select:function(a){var b=this;a.$text=b.$elem,a.selStart=b.tfOff,b.endOff=a.selEnd=b.tfOff+parseInt(a.$selTile.data("len")||"1",10),a.$prevTile&&(a.prevStart=b.tfOff,a.prevEnd=b.tfOff+parseInt(a.$prevTile.data("len")||"1",10)),b.$tile=a.$selTile;var c=a.$selTile.data("fsk");b.$elem.data("fsk",c).addClass("idl-tagged idl-mantagged").removeClass("idl-untagged"),b.$elem.parent().trigger("tm_itl_sensesel",a);var d=!0;if("function"==typeof b.options.sensesel&&(d=b.options.sensesel.call(this,a)),d)if("tile"===b.options.wordsContent)b.$elem[0].innerHTML=a.$selTile[0].outerHTML,b.$elem.senseCard({lgcc:b.options.senseMenuOptions.lgcc});else{var e=b.$elem,f="";do f+=e.data("tok")||e.text(),e=e.next();while(e.length&&(!e.data("off")||e.data("off")<b.endOff));b.$elem.text(f.trim().replace(/ /g,"_"))}b.options.closeOnSelect&&b.close()},deselect:function(){var a=this;a.$elem.addClass("idl-untagged").removeClass("idl-tagged idl-mantagged").removeData("fsk"),a.endOff=a.tfOff+1;var b={selStart:a.tfOff,selEnd:a.tfOff+1};a.$tile&&(b.prevStart=a.tfOff,b.prevEnd=a.tfOff+parseInt(a.$tile.data("len")||"1",10)),a.$elem.parent().trigger("tm_itl_sensesel",b);var c=!0;"function"==typeof a.options.sensedesel&&(c=a.options.sensedesel.call(this,event)!==!1),c&&a.$elem.text(a.$elem.data("tok"))},setSelected:function(a){this.menuW.select(a)},selected:function(){return this.menuW.selected()},setView:function(a){this.menuW.setView(a)},polysemous:function(){return this.$menu.find(".idl-tile-container").length>1},startOffset:function(){return this.tfOff},endOffset:function(){return this.endOff},_htmlClickHandler:function(b){a(b.target).closest(".idl-sensemenu").size()>0||(!d&&e&&e.close(),d=!1)},_monitorHtmlClicks:function(b){var c=this;b?(0===f&&a("html").on("click",c._htmlClickHandler),f++):(--f,0===f&&a("html").off("click",c._htmlClickHandler))},open:function(){var a=this;a.$elem.is(":visible")&&("function"==typeof a.options.beforeOpen&&a.options.beforeOpen(this),a._monitorHtmlClicks(!0),e&&e.close(),a.options.useToolTip&&a._popover({show:!1}),a.menuW.open(),a.$elem.addClass("idl-active"),e=a,d=!0)},close:function(){if(e==this){var a=this;a._monitorHtmlClicks(!1),e=null,a.menuW.close(),a.$elem.removeClass("idl-active"),"function"==typeof a.options.afterClose&&a.options.afterClose(this)}},destroy:function(){var a=this;a.menuW.destroy(),a.options.useToolTip&&a._popover({show:!1})},_popover:function(a){var b=this;a.hasOwnProperty("show")&&(b.showingPopup=a.show);var c=b.$elem;c.popover("destroy"),b.showingPopup&&a.content&&(c.popover({content:a.content,container:!1,html:!0,placement:"auto",delay:500,trigger:"hover",animation:!1}),c.popover("show"))},_create:function(){var b=this;if("tile"===b.options.wordsContent){var c=b.$menu.find(".idl-tile-container[data-grp]").first();0!==c.length?(b.$tile=c,b.$elem[0].innerHTML=b.$tile[0].outerHTML):(b.$elem[0].innerHTML='<div class="idl-tile-container idl-sensesel idl-tile-img idl-menu-sensecard idl-tmplt-menu_image_v1" data-grp="1"><div class="idl-sensetile"><div class="idl-def-tgl"><span class="fa fa-chevron-down"></span></div><div class="idl-tile-sum"><h1>'+b.$elem.data("tok")+'</h1></div><div class="idl-def"><p>Any sense (no known meaning).</p></div></div></div>',b.$tile=b.$elem.find(".idl-tile-container").first())}b.menuW=b.$menu.senseMenu(a.extend({},b.options.senseMenuOptions,{sensesel:function(a){b.select(a)},createsel:function(a){a.$text=b.$elem,b.options.createsel(a),b.options.closeOnSelect&&b.close()}})).data("senseMenu"),b.$elem.on({click:function(a){b.polysemous()&&b.open()}}),b.$elem.addClass("idl-untagged")},_skToLemma:function(a){var b=a.lastIndexOf("/");return-1!=b&&(a=a.substr(0,b)),a.replace(/_/g," ")}},h={init:function(a,b,c){var d=this;d.$elem=a,d.tfOff=b,d.isWord=c},startOffset:function(){return this.tfOff},endOffset:function(){return this.isWord?this.tfOff+1:this.tfOff}},i={init:function(b,c){var d=this;d.$elem=a(c),d.options=a.extend({},a.fn.taggingMenu.options,d.$elem.data(),b),d.words=[],d.gaps=[],d.sensecards={},d.tmplt=b.menus.children().first().data("tmplt"),d._create()},text:function(){var b=this,c="";return b.$elem.children().each(function(b,d){$elem=a(d),$elem.is(":visible")&&(c+=$elem.text())}),c},senses:function(){var b=this,c="";return b.$elem.children().each(function(b,d){if($elem=a(d),"inline"==$elem.css("display")||$elem.hasClass("hidden")){if($elem.hasClass("idl-tagged")){var e=$elem.data("fsk");if(e)return void(c+=e)}c+=$elem.data("tok")||$elem.text()}}),c},sensesAsObjects:function(){for(var b,c=this,d=[],e=0,f="",g=c.$elem.children(),h=0,i=g.length;i>h;++h){var j=a(g[h]);if(j.hasClass("idl-menu-word")){var k=c.words[j.data("widx")];if(k.tfOff===e){void 0!==b&&(b.text=f.trim(),d.push(b),f=""),b={start:k.tfOff,len:k.endOff-k.tfOff,spcAft:!1};var l=j.data("fsk");l&&(b.fsk=l),e=k.endOff}f+=j.data("tok")}else{var m=c.gaps[j.data("gidx")];m.isWord&&m.tfOff===e?(void 0!==b&&(b.text=f.trim(),d.push(b),f=""),b={start:m.tfOff,len:1,spcAft:!1},e=m.endOffset()):m.isWord||m.tfOff!==e||void 0!==b&&(b.spcAft=!0),f+=j.text()}}return b.text=f.trim(),d.push(b),d},select:function(a,b){var c=this,d=a.data("widx");"undefined"!=typeof d&&c.words[d].setSelected(b)},deselect:function(a){var b=this,c=a.data("widx");"undefined"!=typeof c&&b.words[c].deselect()},deselectAll:function(){this.words.forEach(function(a){a.deselect()})},close:function(){this.words.forEach(function(a){a.close()})},destroy:function(){this.words.forEach(function(a){a.destroy()}),this.$elem.removeData("taggingMenu")},_getSenseCard:function(b){var c=this,d=void 0,e={tmplt:c.tmplt},f=b.$tile.data("fsk");e.fsk=d=f,d=d.replace(/\W/g,"");var g=c.sensecards[d];return void 0!==g?g:(a.ajax({data:e,type:"GET",url:c.options.apiUrl+"sensecard.js",dataType:"jsonp"}).done(function(a){var e=a.card;c.sensecards[d]=e,b._popover({content:e})}),"")},_create:function(){var c=this,d=a.extend({},c.options,{sensesel:function(a){return a.allset=!c.$elem.children(".idl-untagged").is(":visible"),c.options.informOnOther&&a.$selTile.hasClass("idl-tile-other")&&b.setTimeout(c.notifyOnOther,1e3,c,a),"function"==typeof c.options.sensesel?c.options.sensesel.call(this,a):!0}});"tile"===c.options.wordsContent?c.options.useToolTip&&alert('TaggingMenu "useToolTip" option should be false when "wordsContent" option is "tile".'):c.$elem.addClass("idl-text-mode"),c.options.useToolTip&&(void 0!==c.$elem.popover?c.$elem.on("mouseenter mouseleave",".idl-tagged",function(b){var d=a(this),e=c.words[d.data("widx")];if("mouseenter"===b.type){var f=c._getSenseCard(e);""!==f?e._popover({show:!0,content:f}):e._popover({show:!0})}else e._popover({show:!1})}):alert("Using tooltip without popover defined. Set useToolTip to false in options.")),c.options.menus.on("click",".idl-to-carousel, .idl-to-grid",function(b){var d=a(b.currentTarget).data("view");c.words.forEach(function(a){a.setView(d)}),b.stopPropagation()}),c.$elem.on("tm_itl_sensesel",function(a,b){c._senseSelHdlr(b)});var e=-1;c.$elem.children().each(function(b,f){var i=a(f);if(i.hasClass("idl-menu-word")){e=parseInt(i.data("off"),10);var j=Object.create(g),k=c.options.menus.children('[data-off="'+e+'"]');j.init(d,i,k);var l=c.words.length;i.data("widx",l),c.words[l]=j}else{var m=Object.create(h),n=i.data("off");e=void 0!==n?parseInt(n,10):e+1,m.init(i,e,void 0!==n),c.options.hideUntaggable&&i.text().trim().length&&i.addClass("hidden");var o=c.gaps.length;i.data("gidx",o),c.gaps[o]=m}});for(var f=0;f<c.words.length;++f){var i=c.words[f],j=i.selected();j?"sa"===c.options.preselect||"mono"===c.options.preselect&&!i.polysemous()?i.setSelected(j):j.removeClass("idl-sensesel"):i.$elem.is(":visible")&&i.$tile&&i.setSelected(i.$tile)}},_senseSelHdlr:function(b){for(var c=this,d=b.selEnd,e=Math.max(b.selEnd,b.prevEnd),f=b.$text.nextAll(),g=0;g<f.length;++g){var h=a(f[g]);if(h.hasClass("idl-menu-word")){var i=c.words[h.data("widx")],j=i.startOffset(),k=i.endOffset();if(j===e)break;d>j?h.hide():(d=k,"tile"===c.options.wordsContent&&i.$tile&&i.setSelected(i.$tile),h.show()),k>e&&(e=k)}else{var l=c.gaps[h.data("gidx")],m=l.tfOff;d>m?h.hide():(h.show(),d=l.endOffset())}}},notifyOnOther:function(b,c){a.get(b.options.apiUrl+"other_sense.js",{text:b.text(),word:c.$text.text()})}};a.fn.taggingMenu=function(b){return this.each(function(){var c=a(this),d=c.data("taggingMenu");void 0===d&&(d=Object.create(i),c.data("taggingMenu",d)),d.init(b,this)})},a.fn.taggingMenu.options={menus:null,useToolTip:!0,wordsContent:"text",hideUntaggable:!1,informOnOther:!0,closeOnSelect:!0,apiUrl:"https://api.idilia.com/1/kb/",preselect:"sa",senseMenuOptions:{},sensesel:null,sensedesel:null,createsel:null,beforeOpen:null,afterClose:null}}(jQuery,window,document);